Set dbs = CurrentDb 'Указываем, что используется именно текущая база данных
'обьявляется ВСЕГДА, если есть обращение к обьектам данной базы
strИсточникФормы = "KP_COZ2"
If Me.butНАЙТИ_ЦЕХ.Caption = "НАЙТИ ЦЕХ" Then ' Если кнопка имеет имя "НАЙТИ ЦЕХ" то выполнить
'этот блок цикла If
'Далее переменная strTabn принимает значение от стандартной функции InputBox
   strTabn = InputBox("ПОЖАЛУЙСТА, ВВЕДИТЕ ИСКОМЫЙ ЦЕХ", "ПОИСК ДАННЫХ ПО ЦЕХУ.")
   If strTabn = "" Then ' Если нет ничего - то ОТКАТ ОПЕРАЦИИ ПОИСК
      MsgBox "ОТКАТ ОПЕРАЦИИ ПОИСК.", vbInformation, "ПОИСК ДАННЫХ ПО ЦЕХУ."
   Else ' если иначе, то
     Set rstSQL = dbs.OpenRecordset(strИсточникФормы) 'Переменной с именем rstSQL присваиваем обьект данной базы -
'в данном случае запрос с именем strИсточникФормы = "KP_COZ2" являющийся источником данной формы
'и вычисляем длину слова в поле CEH
     lngДлинаПоля = CLng(rstSQL.Fields("CEH").Size)
' вычислить длину принятого слова от функции InputBox
     lngДлинаСлова = CLng(Len(strTabn))
     
         If lngДлинаСлова <> lngДлинаПоля Then ' если не равно - то выбросить сообщение и перевести фокус на кнопку
            MsgBox "НЕВЕРНОЕ ЗНАЧЕНИЕ ИСКОМОГО ПОЛЯ" & " " & "=" & " " & lngДлинаСлова & Chr(13) & _
            "НЕОБХОДИМО" & " " & lngДлинаПоля & " - ЗНАЧНОЕ", vbCritical, "ОШИБКА ВВОДА НОМЕРА"
         ElseIf lngДлинаСлова = lngДлинаПоля Then 'если равно - то проверить а если такой таб.номер вообще
           rstSQL.Close 'закрываем открытый обьект
           'строке запроса передаем переменную strTabn
           strSQL = "SELECT KP_COZ.CEH FROM KP_COZ WHERE KP_COZ.CEH = '" & strTabn & "'"
           Set rstSQL = dbs.OpenRecordset(strSQL) 'присваиваем переменной rstSQL содержание объекта KP_COZ и открываем этот запрос
           If rstSQL.EOF = False Then 'если запрос нашел такой номер, то открыть форму на этой строке
              DoCmd.OpenForm "KP_COZ_2_NOT_LIK_POM", , , "CEH = '" & strTabn & "'"
              Me.butНАЙТИ_ЦЕХ.Caption = "ВЕРНУТЬСЯ" 'переименовать кнопку к имени возврата, чтобы вернуться
              Me.butНАЙТИ_ЦЕХ.SetFocus 'перевести фокус на кнопку
           Else 'если запрос не нашел такой номер
              MsgBox "ЦЕХА" & " " & strTabn & Chr(13) & _
              "В БАЗЕ ПРОГРАММЫ НЕТ", vbCritical, "ОШИБКА ВВОДА НОМЕРА"
           End If
         End If
   rstSQL.Close 'закрыть запрос strИсточникФормы = "KP_COZ2", если мы не попали в тело цикла If lngДлинаСлова <> lngДлинаПоля Then
   End If
ElseIf Me.butНАЙТИ_ЦЕХ.Caption = "ВЕРНУТЬСЯ" Then ' Если кнопка имеет имя "ВЕРНУТЬСЯ" то выполнить
'этот блок конструкции ElseIf .. Then
   Me.butНАЙТИ_ЦЕХ.Caption = "НАЙТИ ЦЕХ" 'переименовать кнопку к исходному имени "НАЙТИ CEH"
'  и присвоить форме исходный источник данных, в данном случае - strИсточникФормы = "KP_COZ2"
   Me.RecordSource = strИсточникФормы
End If
Me.butНАЙТИ_ЦЕХ.SetFocus 'перевести фокус на кнопку

Set rstSQL = Nothing 'очистить память от переменной запроса
Set dbs = Nothing 'очистить память от переменной базы
'Если эту процедуру использовать в модуле класса форм т.е, в разных формах, то обязательно
'переменные обявляются - как Public, в стандартном модуле!
