&НаКлиенте
Процедура ПечатьОсновная(ВариантОтчета)
	
	//проверка
	Если ПроверитьЗаполнение() = Ложь Тогда
		Возврат;
	КонецЕсли;
	Если Объект.Сотрудники.Количество() = 0 Тогда
		Возврат;
	КонецЕсли;
	
	//информационное сообщение
	ТекстСообщения = НСтр("ru = 'Выполняется формирование трудового договора без СОУТ ...'");
	Состояние(ТекстСообщения);
	
	//формируем файлы для каждого сотрудника
	Для Каждого СтрокаСотрудника Из Объект.Сотрудники Цикл
		
		//параметры
		ЗакрытьОкноПечатнойФормы = Ложь;
		
		//получение данных
		ИмяМакета = "ПФ_MXL_ТрудовойДоговор_ОФК";
		МакетИДанныеОбъекта = ПолучитьДанныеПечати(ИмяМакета, СтрокаСотрудника.НомерСтроки);
		
		ТипМакета				= МакетИДанныеОбъекта.Макеты.ТипыМакетов[ИмяМакета];
		ДвоичныеДанныеМакетов	= МакетИДанныеОбъекта.Макеты.ДвоичныеДанныеМакетов;
		Области					= МакетИДанныеОбъекта.Макеты.ОписаниеОбластей;
		ДанныеДляПечати			= МакетИДанныеОбъекта.ДанныеДляПечати;
		
		Макет = УправлениеПечатьюКлиент.ИнициализироватьМакетОфисногоДокумента(ДвоичныеДанныеМакетов[ИмяМакета], ТипМакета, ИмяМакета);
		Если Макет = Неопределено Тогда
			Возврат;                                   
		КонецЕсли;
		
		//формирование отчета
		Попытка
		
			ПечатнаяФорма = ИнициализироватьПечатнуюФормуИгорь(ТипМакета, Макет.НастройкиСтраницыМакета, , ДвоичныеДанныеМакетов[ИмяМакета]);
			Если ПечатнаяФорма = Неопределено Тогда
				Макет.Удалить("ИмяФайла");
				УправлениеПечатьюКлиент.ОчиститьСсылки(Макет);
				Возврат;
			КонецЕсли;
			
			//Блок0 - данные договора
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок0"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФорма, Область, ДанныеДляПечати, Ложь);
			
			//Блок1 - предмет договоа
			Если ВариантОтчета = "БезСОУТ" Тогда
				Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок1безСОУТ"]);
			Иначе
				Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок1"]);
			КонецЕсли;
			УправлениеПечатьюКлиент.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФорма, Область, ДанныеДляПечати, Ложь);
			
			//Блок2
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок2"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок3
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок3"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок4 - условия оплаты труда
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок4"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФорма, Область, ДанныеДляПечати, Ложь);
			
			//Блок5
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок5"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок6
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок6"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Разрыв раздела, что бы был другой колонтитул на странице
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["БлокРазрыв"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок7
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок7"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок8
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок8"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок9
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок9"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбласть(ПечатнаяФорма, Область, Ложь);
			
			//Блок10 - реквизиты сторон
			Область = УправлениеПечатьюКлиент.ОбластьМакета(Макет, Области["Блок10"]);
			УправлениеПечатьюКлиент.ПрисоединитьОбластьИЗаполнитьПараметры(ПечатнаяФорма, Область, ДанныеДляПечати, Ложь);
		
			//установка параметров колонтитулов (номер страницы + подписи на каждом листе)
			ИзмененитьКолонтитулыДляРазделов(ПечатнаяФорма, ДанныеДляПечати);
			
			//покажем документ
			УправлениеПечатьюКлиент.ПоказатьДокумент(ПечатнаяФорма);
		
		Исключение
			
			ОбщегоНазначенияКлиентСервер.СообщитьПользователю(КраткоеПредставлениеОшибки(ИнформацияОбОшибке()));
			ЗакрытьОкноПечатнойФормы = Истина;
			
		КонецПопытки;
		
		//завершение
		Попытка
			ПечатнаяФорма.Удалить("ИмяФайла");
		Исключение
		КонецПопытки;
		УправлениеПечатьюКлиент.ОчиститьСсылки(ПечатнаяФорма, ЗакрытьОкноПечатнойФормы);
		
		Макет.Удалить("ИмяФайла");
		УправлениеПечатьюКлиент.ОчиститьСсылки(Макет);
		
	КонецЦикла;
	
КонецПроцедуры
