#Область Справки182н

&НаКлиенте
Процедура Рассчитать4(Команда)
	
	//проверка
	Если Не ПроверитьЗаполнение() Тогда
		Возврат;
	КонецЕсли;
	Если Объект.РасчетСреднегоПриУвольнении.Количество() = 0 Тогда
		Возврат;
	КонецЕсли;
	
	//создание справок
	Для Каждого СтрокаТЧ Из Объект.РасчетСреднегоПриУвольнении Цикл
		
		ПараметрыДокумента = ПолучитьПараметрыСправки182н(СтрокаТЧ.Сотрудник);
		
		ФормаСправки182н = ПолучитьФорму("Документ.ИсходящаяСправкаОЗаработкеДляРасчетаПособий.ФормаОбъекта", ПараметрыДокумента, , ПараметрыДокумента.Основание.ИДФормы);
		// Важно! В объекте Документ.ИсходящаяСправкаОЗаработкеДляРасчетаПособий в модуле объекта доработа процедура ОбработкаЗаполнения()
		ФормаСправки182н.Открыть();
		
	КонецЦикла;
	
	//завершение
	ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Обработка формирования справок 182н выполнена!");
	
КонецПроцедуры

&НаСервере
Функция ПолучитьПараметрыСправки182н(Сотрудник)
	
	ИДФормы = Новый УникальныйИдентификатор;
	ИДФормы = СокрЛП(ИДФормы);
	
	ПараметрыДокумента = Новый Структура();
	ПараметрыДокумента.Вставить("Дата", 				Объект.ДатаУвольнения);
	ПараметрыДокумента.Вставить("ДатаУвольнения", 		Объект.ДатаУвольнения);
	ПараметрыДокумента.Вставить("Организация", 			Объект.Организация);
	ПараметрыДокумента.Вставить("Сотрудник", 			Сотрудник);
	ПараметрыДокумента.Вставить("ИДФормы", 				ИДФормы);
	
	ПараметрыИтог = Новый Структура();
	ПараметрыИтог.Вставить("Основание", ПараметрыДокумента);
	
	Возврат ПараметрыИтог;
	
КонецФункции

#КонецОбласти
