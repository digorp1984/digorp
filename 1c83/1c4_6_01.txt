&НаКлиенте
Функция ВыполнитьЗагрузкуИзExcel()
	
	МассивСтруктур = Новый Массив;
	
	Попытка
		Excel = Новый COMОбъект("Excel.Application");
		Книга = Excel.Workbooks.Open(Объект.ПутьКФайлу);
		Лист	= Книга.WorkSheets(1);
		
		xlCellTypeLastCell = 11;
		Лист.Cells.SpecialCells(xlCellTypeLastCell).Activate();
		ЛистВысота = Excel.ActiveCell.Row;
		ЛистШирина = Excel.ActiveCell.Column;
		
		Если ЛистШирина <= 26 Тогда
			СтрокаШирины = Символ(КодСимвола("A") + ЛистШирина - 1);
		Иначе
			СтрокаШирины = Символ(КодСимвола("A") + (ЛистШирина - 1)/26 - 1) + Символ(КодСимвола("A") + (ЛистШирина-1)%26);
		КонецЕсли;
		
		Матрица = Лист.Range("A" + Формат(1, "ЧГ = 0") + ":" + СтрокаШирины + Формат(ЛистВысота, "ЧГ = 0")).Value.Выгрузить();
		
		ЗначениеКолонки1 = "";
		ЗначениеКолонки2 = "";
		
		Для НомерСтроки = Объект.НомерПервойЗначимойСтроки По ЛистВысота Цикл
			
			СтруктураДанных	= Новый Структура;
			
			Если ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиКоличествоДнейОтпуска - 1][НомерСтроки - 1])
				И ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиДатаНачалаОтпуска - 1][НомерСтроки - 1]) Тогда
				
				//ФИО
				ИмяКолонки1	= "К1";
				Если ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиИмяСотрудника -1][НомерСтроки - 1]) Тогда
					ЗначениеКолонки1 = СокрЛП(Матрица[Объект.НомерКолонкиИмяСотрудника - 1][НомерСтроки - 1]);
					СтруктураДанных.Вставить(ИмяКолонки1, ЗначениеКолонки1);
				Иначе
					СтруктураДанных.Вставить(ИмяКолонки1, ЗначениеКолонки1);
				КонецЕсли;
				
				//табельный номер
				ИмяКолонки2	= "К2";
				Если ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиТабельныйНомер -1][НомерСтроки - 1]) Тогда
					ЗначениеКолонки2 = Матрица[Объект.НомерКолонкиТабельныйНомер - 1][НомерСтроки - 1];
					Если ТипЗнч(ЗначениеКолонки2) = Тип("Число") Тогда
						ЗначениеКолонки2 = Формат(ЗначениеКолонки2, "ЧДЦ=; ЧГ=0");
					Иначе
						ЗначениеКолонки2 = СокрЛП(ЗначениеКолонки2);
					КонецЕсли;
					СтруктураДанных.Вставить(ИмяКолонки2, ЗначениеКолонки2);
				Иначе
					СтруктураДанных.Вставить(ИмяКолонки2, ЗначениеКолонки2);
				КонецЕсли;
				
				//дни
				ИмяКолонки3	= "К3";
				Если ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиКоличествоДнейОтпуска - 1][НомерСтроки - 1]) Тогда
					ЗначениеКолонки3 = Матрица[Объект.НомерКолонкиКоличествоДнейОтпуска - 1][НомерСтроки - 1];
					СтруктураДанных.Вставить(ИмяКолонки3, ЗначениеКолонки3);
				Иначе
					СтруктураДанных.Вставить(ИмяКолонки3, 0);
				КонецЕсли;
				
				//дата начала
				ИмяКолонки4	= "К4";
				Если ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиДатаНачалаОтпуска - 1][НомерСтроки - 1]) Тогда
					ЗначениеКолонки4 = СокрЛП(Матрица[Объект.НомерКолонкиДатаНачалаОтпуска - 1][НомерСтроки - 1]);
					Попытка
						ЗначениеКолонки4День = Число(Лев(ЗначениеКолонки4, 2));
						ЗначениеКолонки4Месяц = Число(Сред(ЗначениеКолонки4, 4, 2));
						ЗначениеКолонки4Год = Число(Прав(ЗначениеКолонки4, 4));
						ЗначениеКолонки4Дата = Дата(ЗначениеКолонки4Год, ЗначениеКолонки4Месяц, ЗначениеКолонки4День);
						СтруктураДанных.Вставить(ИмяКолонки4, ЗначениеКолонки4Дата);
					Исключение
						СтруктураДанных.Вставить(ИмяКолонки4, Дата(1,1,1));
					КонецПопытки;
				Иначе
					СтруктураДанных.Вставить(ИмяКолонки4, Дата(1,1,1));
				КонецЕсли;
				
				//примимечание
				ИмяКолонки5	= "К5";
				Если ЗначениеЗаполнено(Матрица[Объект.НомерКолонкиПримечание - 1][НомерСтроки - 1]) Тогда
					ЗначениеКолонки5	= Матрица[Объект.НомерКолонкиПримечание - 1][НомерСтроки - 1];
					СтруктураДанных.Вставить(ИмяКолонки5, ЗначениеКолонки5);
				Иначе
					СтруктураДанных.Вставить(ИмяКолонки5, "");
				КонецЕсли;
				
				МассивСтруктур.Добавить(СтруктураДанных);
				
			КонецЕсли;
			
		КонецЦикла;
		
		Книга.Close();
		
	Исключение
		Сообщить(ОписаниеОшибки());
		МассивСтруктур	= Неопределено;
	КонецПопытки;
	
	Если Excel.Workbooks.Count() = 0 Тогда
		Excel.Quit();
		Excel = 0;
	КонецЕсли;
	
	Возврат МассивСтруктур;
	
КонецФункции
