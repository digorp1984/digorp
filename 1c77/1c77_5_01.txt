//формирование списка документов по ОС
Процедура СформироватьТблОС()
	
	//общие
	ТблОтбор=СоздатьОбъект("ТаблицаЗначений");
	ТблОтбор.НоваяКолонка("Проведен","Строка",1,,"Проведен",4);
	ТблОтбор.НоваяКолонка("ДатаДок","Дата",,,"Дата",10);
	ТблОтбор.НоваяКолонка("Документ",,,,"Документ",25);
	ТблОтбор.НоваяКолонка("НомерДок","Строка",20,,"Номер",10);
	ТблОтбор.НоваяКолонка("Сумма","Число",18,2,"Сумма документа","12");
	ТблОтбор.НоваяКолонка("МестаХранения","Справочник.МестаХранения",,,"МОЛ","30");
	ТблОтбор.НоваяКолонка("Комментарий","Строка",150);
	
	//список документов
	ТблДок=СоздатьОбъект("ТаблицаЗначений");
	ТблДок.НоваяКолонка("ТипДок","Строка",50);
	ТблДок.НоваяКолонка("ВидДок","Число",1,0);//определяет где искать счет ОС
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_Амортизация"; ТблДок.ВидДок = 1;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_БезвПоступление"; ТблДок.ВидДок = 2;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_Библ"; ТблДок.ВидДок = 3;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_ВводОстатков"; ТблДок.ВидДок = 4;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_ВнутреннееПеремещение"; ТблДок.ВидДок = 5;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_КорректировкаАмортизации"; ТблДок.ВидДок = 4;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_МП_АктСписание"; ТблДок.ВидДок = 3;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_МП_Перемещение"; ТблДок.ВидДок = 5;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_МП_Поступление"; ТблДок.ВидДок = 3;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_ОприходованиеИзлишков"; ТблДок.ВидДок = 3;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_Поступление"; ТблДок.ВидДок = 6;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_ПринятиеКУчету"; ТблДок.ВидДок = 7;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_Реконструкция"; ТблДок.ВидДок = 3;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_Списание"; ТблДок.ВидДок = 3;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_СписаниеИнвОбъекта"; ТблДок.ВидДок = 8;
	ТблДок.НоваяСтрока();
	ТблДок.ТипДок = "ОС_СписаниеКапвложений"; ТблДок.ВидДок = 3;
	
	СпДокОС.УдалитьВсе();
	ТблДок.ВыбратьСтроки();
	Пока ТблДок.ПолучитьСтроку() = 1 Цикл
		Док=СоздатьОбъект("Документ."+СокрЛП(ТблДок.ТипДок));
		СпДокОС.ДобавитьЗначение(СокрЛП(ТблДок.ТипДок),Док.Представлениевида());
	КонецЦикла;
	
	//обработка списка
	ТблДок.ВыбратьСтроки();
	Пока ТблДок.ПолучитьСтроку() = 1 Цикл
		Док=СоздатьОбъект("Документ."+СокрЛП(ТблДок.ТипДок));
		Док.ВыбратьДокументы(НачПериод,КонПериод);
		Пока Док.ПолучитьДокумент() = 1 Цикл
			ДокВыбран=0;
			СуммаДок=0;
			Док.ВыбратьСтроки();
			Пока Док.ПолучитьСтроку() = 1 Цикл
				Если (ТблДок.ВидДок=1) или (ТблДок.ВидДок=3)  или (ТблДок.ВидДок=4) или (ТблДок.ВидДок=5) Тогда
					Если СравнитьСчетСоСписком(Док.СчетОС)=1 Тогда
						ДокВыбран=1;
					КонецЕсли;
				ИначеЕсли (ТблДок.ВидДок=2) или (ТблДок.ВидДок=6)  или (ТблДок.ВидДок=7) Тогда
					Если СравнитьСчетСоСписком(Док.СчетДебета)=1 Тогда
						ДокВыбран=1;
					КонецЕсли;
				КонецЕсли;
				
				Если (ТблДок.ВидДок<>1) Тогда
					СуммаДок=СуммаДок+Док.Сумма;
				КонецЕсли;
			КонецЦикла;
			Если ТблДок.ВидДок=8 Тогда
				//только шапка, строк в документе нет
				Если Док.СчетОС=СчетОтбора Тогда
					ДокВыбран=1;
					СуммаДок=Док.Сумма;
				КонецЕсли;
			КонецЕсли;
			
			Если ДокВыбран=1 Тогда
				ТблОтбор.НоваяСтрока();
				ТблОтбор.Проведен = ?(Док.Проведен()=1,"V",?(Док.ПометкаУдаления()=1,"Х",""));
				ТблОтбор.ДатаДок = Док.ДатаДок;
				ТблОтбор.Документ = Док.ТекущийДокумент();
				ТблОтбор.НомерДок = СокрЛП(Док.НомерДок);
				ТблОтбор.Сумма = СуммаДок;
				Если (ТблДок.ВидДок=2) или (ТблДок.ВидДок=3) или (ТблДок.ВидДок=4) или (ТблДок.ВидДок=7) или
					(ТблДок.ВидДок=8) Тогда
					ТблОтбор.МестаХранения=Док.МестоХранения;
				ИначеЕсли ТблДок.ВидДок=5 Тогда
					ТблОтбор.МестаХранения=Док.МестоХраненияПолучатель;
				КонецЕсли;
				ТблОтбор.Комментарий=СокрЛП(Док.Комментарий);
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	//завершение
	ТблОтбор.Сортировать("ДатаДок +");
	ТблДанныеОтбора.Загрузить(ТблОтбор);
	
КонецПроцедуры
