//Печать арматурной-карточки
Процедура ПечатьАК()
	
	//проверка
	Если ПустоеЗначение(Сотрудник)=1 Тогда
		Возврат;
	КонецЕсли;
	
	//расчет
	СпрФирмы=СоздатьОбъект("Справочник.Фирмы");
	СпрФирмы.НайтиПоКоду("000000000001");
	ВоинскаяЧасть = СпрФирмы.ТекущийЭлемент();
	ТабРасчет2=СоздатьОбъект("ТаблицаЗначений");
	ТабРасчет2=РасчитатьОбеспеченностьВоеннослужащего(ВоинскаяЧасть,ТекущийЭлемент());
	
	//определение кол-ва согласно входящего вещевого аттестата (Д0 и К0)
	Док=СоздатьОбъект("Документ.ПостановкаНаУчетВО");
	Док.ВыбратьДокументы();
	Пока Док.ПолучитьДокумент() = 1 Цикл
		Если Док.Проведен()=0 Тогда
			Продолжить;
		КонецЕсли;
		Если Док.Сотрудник=Сотрудник Тогда
			ДокПостановки=Док.ТекущийДокумент();
		КонецЕсли;
	КонецЦикла;
	
	Попытка
		ТабРасчет2.ВыбратьСтроки();
		Пока ТабРасчет2.ПолучитьСтроку() = 1 Цикл
			ДокПостановки.ВыбратьСтроки();
			Пока ДокПостановки.ПолучитьСтроку() = 1 Цикл
				Если ДокПостановки.Номенклатура=ТабРасчет2.Номенклатура Тогда
					НаНачалоДата=ДокПостановки.ДатаНачалаРасчета;
					НаНачало=ДокПостановки.Обеспеченность;
					Для ИИ=1 По 10 Цикл
						ДатаВыдачиСлед=ДокПостановки.ПолучитьАтрибут("ДатаВыдачи"+СокрЛП(ИИ));
						КолвоВыдачиСлед=ДокПостановки.ПолучитьАтрибут("КолвоВыдачи"+СокрЛП(ИИ));
						Если ДатаВыдачиСлед>НаНачалоДата Тогда
							НаНачалоДата=ДатаВыдачиСлед;
							НаНачало=КолвоВыдачиСлед;
						КонецЕсли;
					КонецЦикла;
					ТабРасчет2.НаНачалоДата=НаНачалоДата;
					ТабРасчет2.НаНачало=НаНачало;
				КонецЕсли;
			КонецЦикла;
		КонецЦикла;
	Исключение
	КонецПопытки;
	
	//общие параметры
	ТаблицаПечати = СоздатьОбъект("Таблица");
	ТаблицаПечати.ИсходнаяТаблица("АрматурнаяКарточка");
	ТаблицаПечати.Опции(0,0,0,0,"АрматурнаяКарточка_АСБК");
	ТаблицаПечати.ПараметрыСтраницы(2,,,5,5,5,5,0,0,1);
	ТаблицаПечати.ТолькоПросмотр(1);
	
	//вывод шапки
	ДатаРекв=КонГода(ТекущаяДата());
	ФИО=СокрЛП(Сотрудник.Наименование);
	Звание=СокрЛП(Сотрудник.Звание.Получить(ДатаРекв));
	ДатаЗачисления=СокрЛП(ДатаПостановкиНаУчет);
	Если ПустоеЗначение(ДатаСнятияСУчетаПоПриказу)=1 Тогда
		ДатаИсключения="";
	Иначе
		ДатаИсключения=СокрЛП(ДатаСнятияСУчетаПоПриказу);
	КонецЕсли;
	
	Год1="";
	ТабРасчет2.ПолучитьПараметрыКолонки("Год1",,,,Год1);
	Год1=Лев(СокрЛП(Год1),4);
	Год2="";
	ТабРасчет2.ПолучитьПараметрыКолонки("Год2",,,,Год2);
	Год2=Лев(СокрЛП(Год2),4);
	Год3="";
	ТабРасчет2.ПолучитьПараметрыКолонки("Год3",,,,Год3);
	Год3=Лев(СокрЛП(Год3),4);
	Год4="";
	ТабРасчет2.ПолучитьПараметрыКолонки("Год4",,,,Год4);
	Год4=Лев(СокрЛП(Год4),4);
	Год5="";
	ТабРасчет2.ПолучитьПараметрыКолонки("Год5",,,,Год5);
	Год5=Лев(СокрЛП(Год5),4);
	
	ТаблицаПечати.ВывестиСекцию("Шапка");
	
	//вывод строк
	ТабРасчет2.ВыбратьСтроки();
	Пока ТабРасчет2.ПолучитьСтроку() = 1 Цикл
		НаименованиеПредмета=СокрЛП(ТабРасчет2.Номенклатура);
		
		Д0=СокрЛП(ДатаМесяц(ТабРасчет2.НаНачалоДата))+"-"+СокрЛП(ДатаГод(ТабРасчет2.НаНачалоДата));
		К0=?(ТабРасчет2.НаНачало=0,"",ТабРасчет2.НаНачало);
		Д1=СокрЛП(ТабРасчет2.Год1дата);
		Д1=?(Д1="","",Д1);
		К1=?(ТабРасчет2.Год1=0,"",ТабРасчет2.Год1);
		Н1=СокрЛП(ТабРасчет2.Год1Номер);
		Д2=СокрЛП(ТабРасчет2.Год2дата);
		Д2=?(Д2="","",Д2);
		К2=?(ТабРасчет2.Год2=0,"",ТабРасчет2.Год2);
		Н2=СокрЛП(ТабРасчет2.Год2Номер);
		Д3=СокрЛП(ТабРасчет2.Год3дата);
		Д3=?(Д3="","",Д3);
		К3=?(ТабРасчет2.Год3=0,"",ТабРасчет2.Год3);
		Н3=СокрЛП(ТабРасчет2.Год3Номер);
		Д4=СокрЛП(ТабРасчет2.Год4дата);
		Д4=?(Д4="","",Д4);
		К4=?(ТабРасчет2.Год4=0,"",ТабРасчет2.Год4);
		Н4=СокрЛП(ТабРасчет2.Год4Номер);
		Д5=СокрЛП(ТабРасчет2.Год5дата);
		Д5=?(Д5="","",Д5);
		К5=?(ТабРасчет2.Год5=0,"",ТабРасчет2.Год5);
		Н5=СокрЛП(ТабРасчет2.Год5Номер);
		
		Если ПустоеЗначение(ДатаСнятияСУчетаПоПриказу)=0 Тогда
			Остаток=ТабРасчет2.КВыдаче;
		Иначе
			Остаток="";
		КонецЕсли;
		ТаблицаПечати.ВывестиСекцию("Строка");
	КонецЦикла;
	
	//завершение
	ТаблицаПечати.Показать("Норма вещевого довольствия");
	
КонецПроцедуры
